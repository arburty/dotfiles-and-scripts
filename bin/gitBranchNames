#! /bin/bash

# Author: Austin Burt
# Email: austin@burt.us.com
# Date:5/23/19

. ${BASH_SOURCE%/*}/bash-functions      # for die

declare -r mybr=$(git mybr)
declare -r branchnames="$HOME/git/branchnames"

branches=$(git branch)
let columns=$(tput cols)-17

while read line
do
    isCurrBranch=$(echo "$line" | grep "$mybr")
    if [[ ! -z $isCurrBranch ]]
    then
        echo -n "$line"
        line=$(echo "$line" | cut -d " " -f2)
    else
        echo -n "  $line"
    fi
    [[ -f $branchnames ]] || die "no branchFiles file" #TODO don't error out. create it


    description=$(cat $branchnames | grep "$line" | tail -n 1 | cut -d " " -f 2-)
    if [[ $line != "master" ]]
    then
        echo "   | ${description::columns}"
    else
        echo
    fi
done < <(echo "$branches")

exit 0
