#! /bin/bash

# Author: Austin Burt
# Email: austin@burt.us.com
# Date:5/23/19

declare -r PROGRAM=$(basename $0)

declare -r mybr=$(git mybr)
declare -r branchnames="$HOME/git/branchnames"

branches=$(git branch)
let columns=$(tput cols)-17

while read line
do
    isCurrBranch=$(echo $line | grep "$mybr")
    if [[ ! -z $isCurrBranch  ]]
    then
        echo -n "$line"
        line=$(echo "$line" | cut -d " " -f2)
    else
        echo -n "  $line"
    fi
    [ -f $branchnames ] || >&2 echo -e "\nno branchFiles file" && exit 1
    description=$(cat $branchnames | grep "$line" | tail -n 1)
    description=$(echo $description | cut -d " " -f 2-)
    if [[ $line != "master" ]]
    then
        echo "   | ${description::columns}"
        #echo "   | $description"
    else
        echo
    fi
done < <(echo "$branches")

exit 0
